## 项目流程

### 数据预处理
- data/creat_inverted_index.ipynb中提前建立数据集中所有问题中的词语的倒排索引表
- data/unsupervised_classification.ipynb中使用TF-IDF + K-means，进行无监督聚类，将数据集中的所有问题分成N类

### 搜索匹配
- 用户输入的句子——切词——去除停用词——得到用户输入的关键词数组
- model/match_sentvec.py中计算用户输入的句子与K-means分类后每类kernel的余弦相似度，看其是否大于某个阈值，从而判断是与银行业务相关的问题吗？如果是与银行相关的业务，即用户输入的句子与某个聚类相似。则找到此类别中与用户输入的句子的句向量最接近的10个句子。
- model/match_inverted_index.py中对于用户输入的关键词，使用布尔搜索的方法，在字词层面从倒排索引中找到最相似的10个问题。布尔搜索不负责对问题是否和银行相关做最终判断，它只是返回能找到的相似问题，如果找不到，就返回0个。

### 排序
- model/rank.py中对上面的备选句子，用BM25进行排序，选出最相似的问题的答案，作为给用户的回复

### 爬虫搜索答案
- 如果在前面的搜索匹配中，判断输入的问题与银行业务无关，则用model/crawler.py中爬虫去搜狗问问爬取答案，作为给用户的回复

#### 默认答案
- 如果以上都找不到合适的答案，则给个默认回复


---


## 项目优缺点

### 项目优点
- 对于数据库中存在的问题，或相似的问题，基本都能给出正确的回答，准确度较高
- 需要用爬虫爬取的问题，基本也能给出较为满意的回答

### 项目缺点
- 响应速度太慢，一部分问题需要5秒，另一部分需要15秒左右才能给出回应。分析原因，应该主要是因为K-means方法进行无监督聚类后，数据库中的大部分问题都被分到了同一类中，导致这一类的问题响应时间很长

- 没有实现生成式方法。生成式方法难度比较高，加上在这个银行的应用中我觉得查询+爬虫基本能解决大部分问题

### 改进方向
- 响应速度较慢的问题，可以针对分类中样本较多的使用 annoy 加速查找，牺牲一定的精度
- 可以使用生成式方法增加闲聊的场景


---



## 项目启动方法

```
export FLASK_APP=service/app.py
flask run
```
访问 http://127.0.0.1:5000/